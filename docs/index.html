<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chinese Musical Lyrics Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { background-color: #111827; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    .font-serif { font-family: 'Noto Serif SC', serif; }
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in { animation: fade-in 0.5s ease-out forwards; }
  </style>
</head>
<body>
  <div class="min-h-screen bg-gray-900 bg-gradient-to-br from-gray-900 via-gray-900 to-cyan-900/50 text-white">
    <main class="container mx-auto px-4 py-16 flex flex-col items-center">
      <div class="w-full max-w-2xl">
        <header class="text-center mb-12">
          <h1 class="text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300 mb-2">
            AI 中文歌词创作
          </h1>
          <p class="text-lg text-gray-400">将你的灵感，变成一首动人的歌。</p>
        </header>
        
        <div class="mb-6">
          <textarea
            id="prompt"
            placeholder="输入一个故事、一种心情、或一句简单的想法..."
            class="w-full h-32 p-4 bg-gray-800 border-2 border-gray-700 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-gray-200 placeholder-gray-500"
          />
        </div>
        
        <button
          onclick="generateLyrics()"
          class="w-full px-6 py-3 font-semibold text-white bg-cyan-600 rounded-lg hover:bg-cyan-700 disabled:bg-gray-600 mb-4"
          id="generateBtn"
        >
          生成歌词
        </button>
        
        <div class="mb-6 text-center">
          <p class="text-sm text-gray-500 mb-3">没灵感？试试这些：</p>
          <div class="flex flex-wrap gap-2 justify-center">
            <button onclick="setPrompt('雨夜里，一个人在空荡的车站等车')" class="px-3 py-1 text-sm bg-gray-800/50 border border-gray-700 rounded-full hover:bg-gray-700 text-gray-300">雨夜里，一个人在空荡的车站等车</button>
            <button onclick="setPrompt('夏日午后，回忆童年的冰淇淋和蝉鸣')" class="px-3 py-1 text-sm bg-gray-800/50 border border-gray-700 rounded-full hover:bg-gray-700 text-gray-300">夏日午后，回忆童年的冰淇淋和蝉鸣</button>
            <button onclick="setPrompt('一只迷失在未来都市的猫')" class="px-3 py-1 text-sm bg-gray-800/50 border border-gray-700 rounded-full hover:bg-gray-700 text-gray-300">一只迷失在未来都市的猫</button>
          </div>
        </div>
        
        <div id="error" class="hidden p-4 bg-red-900/50 border border-red-700 rounded-lg text-red-300 mb-6"></div>
        <div id="loading" class="hidden p-4 bg-gray-800/50 border border-gray-700 rounded-lg mb-6">生成中...</div>
        <div id="result" class="hidden p-6 bg-gray-800/50 border border-gray-700 rounded-lg"></div>
      </div>
    </main>
  </div>
  
  <script>
    const  AIzaSyBsAaOtiBvtF-0A26VJDuprqUZtB4plN-4;
    
    function setPrompt(text) {
      document.getElementById('prompt').value = text;
    }
    
    async function generateLyrics() {
      const prompt = document.getElementById('prompt').value;
      if (!prompt.trim()) return;
      
      const btn = document.getElementById('generateBtn');
      const loading = document.getElementById('loading');
      const error = document.getElementById('error');
      const result = document.getElementById('result');
      
      btn.disabled = true;
      loading.classList.remove('hidden');
      error.classList.add('hidden');
      result.classList.add('hidden');
      
      try {
        const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=' + API_KEY, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: `You are a Chinese lyricist. Generate song lyrics based on: ${prompt}\n\nRespond ONLY with valid JSON:\n{"title":"song title","lyrics":"lyrics text","analysis":{"genre":"genre","mood":"mood","rhythm":"rhythm","structure":"structure"}}`
              }]
            }]
          })
        });
        
        const data = await response.json();
        if (!data.candidates || !data.candidates[0]) throw new Error('Invalid response');
        
        const text = data.candidates[0].content.parts[0].text;
        const parsed = JSON.parse(text);
        
        result.innerHTML = `
          <h2 class="text-3xl font-bold text-cyan-300 mb-6">${parsed.title}</h2>
          
          <div class="mb-6 grid grid-cols-4 gap-4">
            <div class="text-center p-3 bg-gray-900/40 rounded">
              <p class="text-sm text-gray-400">曲风</p>
              <p class="text-white">${parsed.analysis.genre}</p>
            </div>
            <div class="text-center p-3 bg-gray-900/40 rounded">
              <p class="text-sm text-gray-400">情绪</p>
              <p class="text-white">${parsed.analysis.mood}</p>
            </div>
            <div class="text-center p-3 bg-gray-900/40 rounded">
              <p class="text-sm text-gray-400">节奏</p>
              <p class="text-white">${parsed.analysis.rhythm}</p>
            </div>
            <div class="text-center p-3 bg-gray-900/40 rounded">
              <p class="text-sm text-gray-400">结构</p>
              <p class="text-white">${parsed.analysis.structure}</p>
            </div>
          </div>
          
          <div>
            <h3 class="text-lg font-semibold text-gray-300 mb-3">歌词</h3>
            <div class="whitespace-pre-wrap text-gray-200 leading-relaxed text-center font-serif p-4 bg-gray-900/40 rounded">
              ${parsed.lyrics}
            </div>
          </div>
        `;
        result.classList.remove('hidden');
      } catch (err) {
        error.textContent = '错误: ' + (err.message || 'Failed to generate');
        error.classList.remove('hidden');
      } finally {
        btn.disabled = false;
        loading.classList.add('hidden');
      }
    }
  </script>
</body>
</html>
