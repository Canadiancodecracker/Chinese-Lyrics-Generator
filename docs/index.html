<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chinese Musical Lyrics Generator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: linear-gradient(135deg, #111827 0%, #1a2d4d 100%); color: #fff; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; min-height: 100vh; }
    .container { max-width: 800px; margin: 0 auto; padding: 40px 20px; }
    header { text-align: center; margin-bottom: 40px; }
    h1 { font-size: 48px; margin-bottom: 10px; background: linear-gradient(135deg, #60a5fa, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .subtitle { font-size: 18px; color: #9ca3af; }
    textarea { width: 100%; height: 120px; padding: 16px; background: #1f2937; border: 2px solid #374151; border-radius: 8px; color: #e5e7eb; font-size: 16px; resize: none; margin-bottom: 16px; }
    textarea:focus { outline: none; border-color: #06b6d4; }
    button { width: 100%; padding: 12px; font-size: 16px; font-weight: 600; background: #0891b2; color: white; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 16px; }
    button:hover { background: #0e7490; }
    button:disabled { background: #4b5563; cursor: not-allowed; }
    .examples { text-align: center; margin-bottom: 20px; }
    .examples p { font-size: 14px; color: #9ca3af; margin-bottom: 10px; }
    .example-btn { display: inline-block; margin: 5px; padding: 8px 12px; background: #374151; border: 1px solid #4b5563; border-radius: 20px; color: #d1d5db; cursor: pointer; font-size: 14px; }
    .example-btn:hover { background: #4b5563; border-color: #06b6d4; }
    .error { padding: 16px; background: #7f1d1d; border: 1px solid #dc2626; border-radius: 8px; color: #fca5a5; margin-bottom: 16px; display: none; }
    .loading { padding: 16px; background: #1f2937; border: 1px solid #374151; border-radius: 8px; text-align: center; display: none; }
    .result { padding: 24px; background: #1f2937; border: 1px solid #374151; border-radius: 8px; display: none; }
    .result h2 { font-size: 32px; color: #06b6d4; margin-bottom: 20px; text-align: center; }
    .analysis { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 20px; }
    .analysis-item { text-align: center; padding: 12px; background: #111827; border-radius: 6px; }
    .analysis-item p:first-child { font-size: 12px; color: #9ca3af; margin-bottom: 5px; }
    .analysis-item p:last-child { color: white; }
    .lyrics-section h3 { font-size: 18px; color: #d1d5db; margin-bottom: 12px; }
    .lyrics-text { white-space: pre-wrap; color: #d1d5db; line-height: 1.6; font-family: 'Noto Serif SC', serif; padding: 16px; background: #111827; border-radius: 6px; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>AI 中文歌词创作</h1>
      <p class="subtitle">将你的灵感，变成一首动人的歌。</p>
    </header>
    
    <textarea id="prompt" placeholder="输入一个故事、一种心情、或一句简单的想法..."></textarea>
    
    <button id="generateBtn" onclick="generateLyrics()">生成歌词</button>
    
    <div class="examples">
      <p>没灵感？试试这些：</p>
      <button class="example-btn" onclick="setPrompt('雨夜里，一个人在空荡的车站等车')">雨夜里，一个人在空荡的车站等车</button>
      <button class="example-btn" onclick="setPrompt('夏日午后，回忆童年的冰淇淋和蝉鸣')">夏日午后，回忆童年的冰淇淋和蝉鸣</button>
      <button class="example-btn" onclick="setPrompt('一只迷失在未来都市的猫')">一只迷失在未来都市的猫</button>
    </div>
    
    <div class="error" id="error"></div>
    <div class="loading" id="loading">生成中...</div>
    
    <div class="result" id="result"></div>
  </div>
  
  <script>
    const API_KEY = 'AIzaSyBsAaOtiBvtF-0A26VJDuprqUZtB4plN-4';
    
    function setPrompt(text) {
      document.getElementById('prompt').value = text;
    }
    
    async function generateLyrics() {
      const prompt = document.getElementById('prompt').value;
      if (!prompt.trim()) return;
      
      const btn = document.getElementById('generateBtn');
      const loading = document.getElementById('loading');
      const error = document.getElementById('error');
      const result = document.getElementById('result');
      
      btn.disabled = true;
      loading.style.display = 'block';
      error.style.display = 'none';
      result.style.display = 'none';
      
      try {
        const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent?key=' + API_KEY, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{
              parts: [{
                text: `You are a Chinese lyricist. Generate song lyrics based on: ${prompt}\n\nRespond ONLY with valid JSON:\n{"title":"song title","lyrics":"lyrics text","analysis":{"genre":"genre","mood":"mood","rhythm":"rhythm","structure":"structure"}}`
              }]
            }]
          })
        });
        
        const data = await response.json();
        if (!data.candidates || !data.candidates[0]) throw new Error('Invalid response');
        
        const text = data.candidates[0].content.parts[0].text;
        const parsed = JSON.parse(text);
        
        result.innerHTML = `
          <h2>${parsed.title}</h2>
          <div class="analysis">
            <div class="analysis-item"><p>曲风</p><p>${parsed.analysis.genre}</p></div>
            <div class="analysis-item"><p>情绪</p><p>${parsed.analysis.mood}</p></div>
            <div class="analysis-item"><p>节奏</p><p>${parsed.analysis.rhythm}</p></div>
            <div class="analysis-item"><p>结构</p><p>${parsed.analysis.structure}</p></div>
          </div>
          <div class="lyrics-section">
            <h3>歌词</h3>
            <div class="lyrics-text">${parsed.lyrics}</div>
          </div>
        `;
        result.style.display = 'block';
      } catch (err) {
        error.textContent = '错误: ' + (err.message || 'Failed to generate');
        error.style.display = 'block';
      } finally {
        btn.disabled = false;
        loading.style.display = 'none';
      }
    }
  </script>
</body>
</html>
